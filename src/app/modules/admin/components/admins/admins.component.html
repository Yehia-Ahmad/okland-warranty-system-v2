<app-side-nav>
    <div class="w-full flex flex-col items-start gap-8">
        <div class="w-full flex items-center justify-center">
            <h1 class="text-2xl font-bold font-azonix text-gray_light">{{ 'admin.title' | translate}}</h1>
        </div>
        <div class="w-full flex items-center justify-between">
            <p-button label="{{ 'admin.add_Button' | translate}}" (click)="showDialog('add')"
                styleClass="!px-4 !py-2 !w-full !border-none !text-xl !font-bold !text-gray_dark !bg-orange" />
            <div class="sm:w-1/5 lg:min-w-[25%] py-2 px-2 rounded-md hidden sm:block" [ngClass]="{
                'text-orange bg-gray_dark': isDarkMode$ | async,
                'border border-orange bg-light_bg text-orange': !(isDarkMode$ | async),
            }">
                <input class="border-none outline-none focus:border-none focus:outline-none bg-transparent" [ngClass]="{
                        'text-orange': !(isDarkMode$ | async),
                        'text-light_orange ': (isDarkMode$ | async)
                    }"placeholder="{{'searchPlaceholder' | translate}}" />
            </div>
        </div>
        <div class="w-full p-4 pb-0 rounded-xl" [ngClass]="{
            'bg-gray_dark': isDarkMode$ | async,
            'bg-light_card_bg': !(isDarkMode$ | async)
        }">
            <table class="w-full border-collapse text-sm text-gray-300">
                <thead>
                    <tr class="bg-[#515151] text-gray-200 uppercase text-xs rounded-md">
                        <th class="py-3 px-4 uppercase text-left text-[#a1a1a1]">{{ 'tableHeaders.username' | translate}}</th>
                        <th class="py-3 px-4 uppercase text-left text-[#a1a1a1]">{{ 'tableHeaders.email' | translate}}</th>
                        <th class="py-3 px-4 uppercase text-left text-[#a1a1a1]">{{ 'tableHeaders.number' | translate}}</th>
                        <th class="py-3 px-4 uppercase text-left text-[#a1a1a1]">{{ 'tableHeaders.role' | translate}}</th>
                        <th class="py-3 px-4 uppercase text-center text-[#a1a1a1]">{{ 'tableHeaders.actions' | translate}}</th>
                    </tr>
                </thead>
                <tbody>
                    @for(admin of admins;track $index){
                        <tr class="" [ngClass]="{'border-b border-b-light_orange': $index < admins.length - 1}">
                            <td class="py-4 px-4 border-r border-r-[#a1a1a1]" [ngClass]="{
                                'text-light_orange': isDarkMode$ | async,
                                'text-orange': !(isDarkMode$ | async)
                            }">{{ admin.username }}</td>
                            <td class="py-4 px-4 border-r border-r-[#a1a1a1]" [ngClass]="{
                                'text-light_orange': isDarkMode$ | async,
                                'text-orange': !(isDarkMode$ | async)
                            }">{{ admin.email }}</td>
                            <td class="py-4 px-4 border-r border-r-[#a1a1a1]"[ngClass]="{
                                'text-light_orange': isDarkMode$ | async,
                                'text-orange': !(isDarkMode$ | async)
                            }">{{ admin.phone }}</td>
                            <td class="py-4 px-4 border-r border-r-[#a1a1a1]"[ngClass]="{
                                'text-light_orange': isDarkMode$ | async,
                                'text-orange': !(isDarkMode$ | async)
                            }">{{ admin.role }}</td>
                            <td class="py-4 px-4 text-center">
                                <div class="flex flex-col items-start gap-4">
                                    <button
                                        class="bg-[#f2c49b] hover:bg-[#f2b77b] text-[#1f1f1f] font-semibold px-4 py-1 rounded-md mr-2" (click)="showDialog('change', admin)">
                                        {{ 'admin.change_Button' | translate}}
                                    </button>
                                    <button class="bg-[#e84c0d] hover:bg-[#c43f0b] text-white font-semibold px-4 py-1 rounded-md" (click)="showDeleteDialog(admin)">
                                        {{ 'admin.remove_Button' | translate}}
                                    </button>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        
        </div>
        <!-- Pagination -->
        <!-- <div class="w-full flex items-center justify-center mt-4 space-x-2 text-gray-400">
            <button class="px-2 text-light_orange">&lt;</button>
            @for(page of pages;track $index){
                <button class="w-7 h-7 rounded-lg text-sm font-medium text-light_orange"
                    [ngClass]="{
                      'bg-orange text-dark': page === currentPage,
                      'hover:text-orange': page !== currentPage
                    }"
                    (click)="goToPage(page)"
                >
                    {{ page }}
                </button>
            }
            <button class="px-2 text-light_orange">&gt;</button>
        </div> -->

    </div>
    <p-dialog [modal]="true" [(visible)]="visible" [style]="{ width: '50vw' }">
        <div class="flex justify-center items-center">
            @if(mode === 'add'){
            <h1 class="text-2xl font-bold font-azonix text-orange">add admin</h1>
            } @else {
            <h1 class="text-2xl font-bold font-azonix text-orange">change admin</h1>
            }
        </div>
        <form class="flex flex-col gap-4 my-6" [formGroup]="changeForm">
            <div class="w-full flex flex-col gap-2 items-start">
                <label class="text-lg font-medium font-roboto text-light_orange" for="username">Username</label>
                <input type="text"
                    class="w-full rounded-md p-2 bg-transparent text-light_orange border border-[#696969] focus:outline-none"
                    pInputText formControlName="username" />
            </div>
            <div class="w-full flex flex-col gap-2 items-start">
                <label class="text-lg font-medium font-roboto text-light_orange" for="email">Email</label>
                <input type="email"
                    class="w-full rounded-md p-2 bg-transparent text-light_orange border border-[#696969] focus:outline-none"
                    pInputText formControlName="email" />
            </div>
            <div class="w-full flex flex-col gap-2 items-start">
                <label class="text-lg font-medium font-roboto text-light_orange" for="phone_number">Phone Number</label>
                <input type="tel"
                    class="w-full rounded-md p-2 bg-transparent text-light_orange border border-[#696969] focus:outline-none"
                    pInputText formControlName="phone" />
            </div>
            <div class="w-full flex flex-col gap-2 items-start">
                <label class="text-lg font-medium font-roboto text-light_orange" for="password">Password</label>
                <input type="password"
                    class="w-full rounded-md p-2 bg-transparent text-light_orange border border-[#696969] focus:outline-none"
                    pInputText formControlName="password" />
            </div>
            <div class="w-full flex flex-col gap-2 items-start">
                <label class="text-lg font-medium font-roboto text-light_orange" for="role">Role</label>
                <p-select [options]="roles" formControlName="role" optionLabel="name" optionValue="value" placeholder="Select Role"
                    class="w-full rounded-md bg-transparent text-light_orange border border-[#696969] focus:outline-none" />
            </div>
        </form>
        <div class="flex justify-center items-center">
            <p-button label="{{isLoading ? ('actions.loading' | translate) : ('actions.save' | translate)}}" styleClass="!p-4 w-full !uppercase !text-xl !font-bold !text-white !bg-orange !font-roboto !border !border-white/30" [disabled]="isLoading " (click)="userHandler()" />
        </div>
    </p-dialog>
    <p-dialog [(visible)]="deleteVisible" styleClass="!border-0">
        <ng-template #headless>
            <div class="flex flex-col px-8 py-8 gap-6 rounded-2xl bg-[#393939]">
                <div class="flex items-center justify-center">
                    <h1 class="text-2xl font-bold font-azonix text-orange">delete admin</h1>
                </div>
                <h6 class="text-lg font-semibold font-roboto text-light_orange">Are you sure you want to delete this
                    admin ?</h6>
                <div class="flex items-center gap-4">
                    <p-button label="{{ 'actions.cancelButton' | translate }}" (click)="closeDialog()" [text]="true"
                        styleClass="!p-4 w-full !uppercase !text-xl !font-bold !text-gray_dark !bg-orange !font-roboto !border !border-white/30"
                        class="w-full" />
                    <p-button label="{{ 'actions.deleteButton' | translate }}" (click)="deleteUser()" [text]="true"
                        styleClass="!p-4 w-full !uppercase !text-xl !font-bold !text-light_orange !bg-red !font-roboto !border !border-white/30"
                        class="w-full" />
                </div>
            </div>
        </ng-template>
    </p-dialog>

    <p-dialog [(visible)]="errorVisible" [modal]="true" [closable]="true" [dismissableMask]="true"
        [style]="{ width: '400px' }" styleClass="!border-0">
        <ng-template #headless>
            <div class="flex flex-col gap-4 p-6 rounded-2xl" [ngClass]="{
                    'bg-gray': isDarkMode$ | async,
                    'bg-light_card_bg': !(isDarkMode$ | async)
                }">
                <app-error-icon class="mx-auto"></app-error-icon>
                <p class="text-center" [ngClass]="{ 
                        'text-light_orange': isDarkMode$ | async,
                        'text-gray_dark': !(isDarkMode$ | async)
                     }">{{ errorMessage }}</p>
                <div class="flex justify-center mt-4">
                    <button type="button" class="px-6 py-2 rounded-lg text-white bg-[#FF9933] hover:opacity-90"
                        (click)="errorVisible = false">
                        OK
                    </button>
                </div>
            </div>
        </ng-template>
    </p-dialog>
</app-side-nav>